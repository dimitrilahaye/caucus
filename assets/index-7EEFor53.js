var ie=e=>{throw TypeError(e)};var ee=(e,t,n)=>t.has(e)||ie("Cannot "+n);var le=(e,t,n)=>(ee(e,t,"read from private field"),n?n.call(e):t.get(e)),te=(e,t,n)=>t.has(e)?ie("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),de=(e,t,n,r)=>(ee(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ne=(e,t,n)=>(ee(e,t,"access private method"),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Se={"cre-impro~characters":"caucus~characters","cre-impro~courses":"caucus~courses","cre-impro~moods":"caucus~moods","cre-impro~places":"caucus~places"};function Ie(){return Object.keys(Se).some(e=>localStorage.getItem(e)!==null)}function Te({oldKey:e,newKey:t}){try{const n=localStorage.getItem(e);return n===null?!0:localStorage.getItem(t)!==null?(console.warn(`Migration: Les données ${t} existent déjà, suppression de ${e}`),localStorage.removeItem(e),!0):(localStorage.setItem(t,n),localStorage.removeItem(e),console.log(`Migration: ${e} → ${t} (${n.length} caractères)`),!0)}catch(n){return console.error(`Erreur lors de la migration ${e} → ${t}:`,n),!1}}function Le(){const e={success:!0,migratedKeys:[],errors:[],totalItems:0};if(!Ie())return console.log("Migration: Aucune donnée ancienne trouvée, migration non nécessaire"),e;console.log("Migration: Début de la migration des données LocalStorage...");for(const[t,n]of Object.entries(Se))if(Te({oldKey:t,newKey:n})){e.migratedKeys.push(`${t} → ${n}`);try{const s=localStorage.getItem(n);if(s){const o=JSON.parse(s);Array.isArray(o)&&(e.totalItems+=o.length)}}catch{}}else e.success=!1,e.errors.push(`Échec de la migration ${t} → ${n}`);return e.success?console.log(`Migration: Succès! ${e.migratedKeys.length} clés migrées, ${e.totalItems} éléments au total`):console.error("Migration: Échec partiel:",e.errors),e}const Ne="caucus~courses";function R(){const e=localStorage.getItem(Ne);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function k({courses:e}){localStorage.setItem(Ne,JSON.stringify(e))}function ue(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Re(){return{async list(){return R()},async create({name:e}){const t=R(),n={id:ue(),name:e,students:[]};return k({courses:[n,...t]}),n},async getById({id:e}){return R().find(n=>n.id===e)||void 0},async rename({id:e,newName:t}){const n=R(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},k({courses:n}),n[r]},async remove({id:e}){const t=R(),n=t.length,r=t.filter(s=>s.id!==e);return k({courses:r}),r.length!==n},async addStudent({courseId:e,studentName:t}){const n=R(),r=n.findIndex(o=>o.id===e);if(r===-1)return;const s={id:ue(),name:t};return n[r]={...n[r],students:[...n[r].students,s]},k({courses:n}),n[r]},async renameStudent({courseId:e,studentId:t,newName:n}){const r=R(),s=r.findIndex(i=>i.id===e);if(s===-1)return;const o=r[s].students.findIndex(i=>i.id===t);if(o===-1)return;const a={...r[s].students[o],name:n},c=r[s].students.slice();return c[o]=a,r[s]={...r[s],students:c},k({courses:r}),r[s]},async removeStudent({courseId:e,studentId:t}){const n=R(),r=n.findIndex(a=>a.id===e);if(r===-1)return!1;const s=n[r].students.length,o=n[r].students.filter(a=>a.id!==t);return n[r]={...n[r],students:o},k({courses:n}),o.length!==s}}}const be="caucus~places";function K(){const e=localStorage.getItem(be);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function re({places:e}){localStorage.setItem(be,JSON.stringify(e))}function we(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Oe(){return{async list(){return K()},async create({name:e}){const t=K(),n={id:we(),name:e};return re({places:[n,...t]}),n},async rename({id:e,newName:t}){const n=K(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},re({places:n}),n[r]},async remove({id:e}){const t=K(),n=t.length,r=t.filter(s=>s.id!==e);return re({places:r}),r.length!==n}}}const ve="caucus~moods";function q(){const e=localStorage.getItem(ve);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function se({moods:e}){localStorage.setItem(ve,JSON.stringify(e))}function Ue(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Pe(){return{async list(){return q()},async create({name:e}){const t=q(),n={id:Ue(),name:e};return se({moods:[n,...t]}),n},async rename({id:e,newName:t}){const n=q(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},se({moods:n}),n[r]},async remove({id:e}){const t=q(),n=t.length,r=t.filter(s=>s.id!==e);return se({moods:r}),r.length!==n}}}const Ae="caucus~characters";function V(){const e=localStorage.getItem(Ae);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function oe({characters:e}){localStorage.setItem(Ae,JSON.stringify(e))}function _e(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Me(){return{async list(){return V()},async create({name:e}){const t=V(),n={id:_e(),name:e};return oe({characters:[n,...t]}),n},async rename({id:e,newName:t}){const n=V(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},oe({characters:n}),n[r]},async remove({id:e}){const t=V(),n=t.length,r=t.filter(s=>s.id!==e);return oe({characters:r}),r.length!==n}}}function De(){return{nextFloat(){return Math.random()}}}function ke({deps:e}){return{async list(){return await e.coursesPort.list()},async getById({id:t}){return await e.coursesPort.getById({id:t})},async create({name:t}){return await e.coursesPort.create({name:t})},async rename({id:t,newName:n}){return await e.coursesPort.rename({id:t,newName:n})},async remove({id:t}){return await e.coursesPort.remove({id:t})},async addStudent({courseId:t,studentName:n}){return await e.coursesPort.addStudent({courseId:t,studentName:n})},async renameStudent({courseId:t,studentId:n,newName:r}){return await e.coursesPort.renameStudent({courseId:t,studentId:n,newName:r})},async removeStudent({courseId:t,studentId:n}){return await e.coursesPort.removeStudent({courseId:t,studentId:n})}}}function He({deps:e}){return{async list(){return await e.placesPort.list()},async create({name:t}){return await e.placesPort.create({name:t})},async rename({id:t,newName:n}){return await e.placesPort.rename({id:t,newName:n})},async remove({id:t}){return await e.placesPort.remove({id:t})}}}function Be({deps:e}){return{async list(){return await e.moodsPort.list()},async create({name:t}){return await e.moodsPort.create({name:t})},async rename({id:t,newName:n}){return await e.moodsPort.rename({id:t,newName:n})},async remove({id:t}){return await e.moodsPort.remove({id:t})}}}function $e({deps:e}){return{async list(){return await e.charactersPort.list()},async create({name:t}){return await e.charactersPort.create({name:t})},async rename({id:t,newName:n}){return await e.charactersPort.rename({id:t,newName:n})},async remove({id:t}){return await e.charactersPort.remove({id:t})}}}function Fe({deps:e}){return{async generate({students:t,placesCount:n}){if(!t.length)throw new Error("Aucun élève sélectionné");const[r,s,o]=await Promise.all([e.charactersPort.list(),e.moodsPort.list(),e.placesPort.list()]);if(r.length<t.length)throw new Error(`Pas assez de personnages (${r.length}) pour ${t.length} élèves`);if(!s.length)throw new Error("Aucune émotion disponible");if(!o.length)throw new Error("Aucun lieu disponible");if(o.length<n){const l=n-o.length;throw new Error(`Il manque ${l} lieu${l>1?"x":""} pour satisfaire la demande (${o.length} disponible${o.length>1?"s":""}, ${n} demandé${n>1?"s":""})`)}const a=[...r],c=[...s],i=[...o];for(let l=a.length-1;l>0;l--){const p=Math.floor(e.randomPort.nextFloat()*(l+1));[a[l],a[p]]=[a[p],a[l]]}for(let l=c.length-1;l>0;l--){const p=Math.floor(e.randomPort.nextFloat()*(l+1));[c[l],c[p]]=[c[p],c[l]]}for(let l=i.length-1;l>0;l--){const p=Math.floor(e.randomPort.nextFloat()*(l+1));[i[l],i[p]]=[i[p],i[l]]}const u=t.map((l,p)=>({student:l,character:a[p],mood:c[p%c.length]})),m=Math.min(n,i.length),d=i.slice(0,m);return{assignments:u,places:d}}}}function Ge(){return{validateStudentSelection({selectedStudents:e,course:t}){return e.size===0?"Sélectionnez au moins un élève":e.size>t.students.length?"Trop d'élèves sélectionnés":null},validatePlacesCount({placesCount:e,availablePlaces:t}){return e<1?"Au moins un lieu est requis":e>t?`Maximum ${t} lieu${t>1?"x":""} disponible${t>1?"s":""}`:null}}}function ze({deps:e}){return{async regeneratePlace({currentPlaces:t,placeIndex:n}){const r=await e.placesPort.list(),s=t.map(i=>i.id),o=t[n].id,a=r.filter(i=>!s.includes(i.id)&&i.id!==o);if(a.length===0)throw new Error("Aucun autre lieu disponible");const c=Math.floor(e.randomPort.nextFloat()*a.length);return a[c]},async regenerateCharacter({currentAssignments:t,assignmentIndex:n}){const r=await e.charactersPort.list(),s=t.map(i=>i.character.id),o=t[n].character.id,a=r.filter(i=>!s.includes(i.id)&&i.id!==o);if(a.length===0)throw new Error("Aucun autre personnage disponible");const c=Math.floor(e.randomPort.nextFloat()*a.length);return a[c]},async regenerateMood({currentAssignments:t,assignmentIndex:n}){const r=await e.moodsPort.list();if(r.length===0)throw new Error("Aucune émotion disponible");const s=t[n].mood.id,o=r.filter(c=>c.id!==s);if(o.length===0)throw new Error("Aucune autre émotion disponible");const a=Math.floor(e.randomPort.nextFloat()*o.length);return o[a]}}}function je(){return{async confirmDeletion({confirmationMessage:e}){return window.confirm(e)}}}function Ke(){const e=De(),t=Re(),n=Oe(),r=Pe(),s=Me();return{coursesUseCase:ke({deps:{coursesPort:t}}),placesUseCase:He({deps:{placesPort:n}}),moodsUseCase:Be({deps:{moodsPort:r}}),charactersUseCase:$e({deps:{charactersPort:s}}),improGenerationUseCase:Fe({deps:{charactersPort:s,moodsPort:r,placesPort:n,randomPort:e}}),validationUseCase:Ge(),regenerationUseCase:ze({deps:{placesPort:n,charactersPort:s,moodsPort:r,randomPort:e}}),deletionUseCase:je()}}function qe({path:e,handler:t}){const n=[],r=e.replace(/\//g,"\\/").replace(/:([A-Za-z0-9_]+)/g,(o,a)=>(n.push(a),"([^/]+)"));return{pattern:new RegExp("^"+r+"$"),keys:n,handler:t}}var F,G,ae;class Ve{constructor(t){te(this,G);te(this,F,[]);de(this,F,t.map(n=>qe({path:n.path,handler:n.handler})))}start(){window.addEventListener("hashchange",()=>ne(this,G,ae).call(this)),location.hash?ne(this,G,ae).call(this):location.hash="#/courses"}}F=new WeakMap,G=new WeakSet,ae=function(){const t=location.hash.replace(/^#/,"");for(const n of le(this,F)){const r=t.match(n.pattern);if(r){const s={};n.keys.forEach((o,a)=>s[o]=decodeURIComponent(r[a+1])),n.handler(s);return}}};function Ye({courses:e,onSubmitHandler:t,createCourseCard:n,createCourseForm:r,createMessage:s}){const o=document.createElement("div");o.className="card";const a=document.createElement("h1");a.textContent="Cours",a.className="text-center mb-lg",o.appendChild(a);const c=r({onSubmitHandler:t});o.appendChild(c);const i=s({text:e.length===0?"Créez votre premier cours":""});o.appendChild(i);const u=document.createElement("div");return u.className="flex flex-col gap-sm",e.forEach(m=>{const d=n({course:m});u.appendChild(d)}),o.appendChild(u),o}function Je({courses:e,createCourseCard:t}){const n=document.createElement("div");return n.className="flex flex-col gap-sm",e.forEach(r=>{const s=t({course:r});n.appendChild(s)}),n}function We({courses:e,createMessage:t}){const n=e.length===0?"Créez votre premier cours":"";return t({text:n})}function Ze({coursesUseCase:e,onRefresh:t}){return async n=>{n.preventDefault();const s=n.target.querySelector('input[name="courseName"]'),o=s.value.trim();if(o)try{await e.create({name:o}),s.value="",await t()}catch(a){console.error("Erreur lors de la création du cours:",a)}}}function me({course:e}){const t=document.createElement("a");t.href=`#/courses/${encodeURIComponent(e.id)}`,t.className="card-compact cursor-pointer",t.style.display="block",t.style.textDecoration="none",t.style.color="inherit";const n=document.createElement("div");return n.textContent=e.name,n.className="text-base font-medium",t.appendChild(n),t}function Qe({onSubmitHandler:e}){const t=document.createElement("form");t.className="flex gap-sm mb-lg";const n=document.createElement("input");n.type="text",n.placeholder="Nom du cours",n.required=!0,n.name="courseName";const r=document.createElement("button");return r.type="submit",r.textContent="+",r.className="btn-secondary btn-match-input",t.appendChild(n),t.appendChild(r),t.addEventListener("submit",e),t}function pe({text:e,className:t="text-center text-muted mb-md"}){const n=document.createElement("p");return n.textContent=e,n.className=t,n}function Xe({root:e,deps:t}){e.innerHTML="";let n=[];async function r(){try{n=await t.coursesUseCase.list(),s()}catch(c){console.error("Erreur lors du chargement des cours:",c)}}function s(){const c=e.querySelector(".card");if(!c)return;const i=c.querySelector(".courses-list");i&&i.remove();const u=Je({courses:n,createCourseCard:me});u.className+=" courses-list",c.appendChild(u);const m=c.querySelector(".courses-message");m&&m.remove();const d=We({courses:n,createMessage:pe});d.className+=" courses-message",c.appendChild(d)}const o=Ze({coursesUseCase:t.coursesUseCase,onRefresh:r}),a=Ye({courses:n,onSubmitHandler:o,createCourseCard:me,createCourseForm:Qe,createMessage:pe});e.appendChild(a),r()}const L={ERRORS:{COURSE_NOT_FOUND:"Cours introuvable",NO_STUDENTS_FOR_IMPRO:"Il faut au moins un élève pour générer une impro"},CONFIRMATIONS:{DELETE_COURSE:"Supprimer ce cours et tous ses élèves ?",DELETE_STUDENT:e=>`Supprimer l'élève "${e}" ?`},LABELS:{BACK_TO_COURSES:"← Retour à la liste des cours",GENERATE_IMPRO:"🎭 Générer une impro",STUDENTS_TITLE:"Élèves",STUDENT_NAME_PLACEHOLDER:"Nom de l'élève",EMPTY_STUDENTS_MESSAGE:"Ajoutez votre premier élève pour ce cours"}},fe={ERROR_FEEDBACK:2e3};function et({course:e}){const t=document.createElement("div");t.className="flex justify-between items-center mb-lg";const n=document.createElement("h1");n.textContent=e.name,n.contentEditable="true",n.className="mb-0 px-2 py-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",n.style.minHeight="2rem",n.style.display="inline-flex",n.style.alignItems="center",n.style.marginBottom="0";const r=document.createElement("button");return r.type="button",r.textContent="🗑️",r.className="btn-danger btn-match-input",t.appendChild(n),t.appendChild(r),{section:t,title:n,deleteBtn:r}}function tt({messages:e}){const t=document.createElement("div");t.className="mb-lg";const n=document.createElement("button");return n.type="button",n.textContent=e.LABELS.GENERATE_IMPRO,n.className="btn-primary btn-lg rounded",t.appendChild(n),{section:t,button:n}}function nt({messages:e}){const t=document.createElement("div");t.className="mb-lg";const n=document.createElement("h3");n.textContent=e.LABELS.STUDENTS_TITLE,n.className="mb-md",t.appendChild(n);const r=document.createElement("form");r.className="flex gap-sm mb-md";const s=document.createElement("input");s.type="text",s.placeholder=e.LABELS.STUDENT_NAME_PLACEHOLDER,s.required=!0,s.name="studentName";const o=document.createElement("button");o.type="submit",o.textContent="+",o.className="btn-secondary btn-match-input",r.appendChild(s),r.appendChild(o),t.appendChild(r);const a=document.createElement("p");a.className="text-center text-muted mb-md",t.appendChild(a);const c=document.createElement("div");return c.className="flex flex-col gap-sm",t.appendChild(c),{section:t,emptyMsg:a,list:c,form:r,input:s}}function rt({student:e}){const t=document.createElement("div");t.className="card",t.style.padding="0.5rem 0.75rem",t.style.minHeight="auto";const n=document.createElement("div");n.className="flex items-center justify-between gap-sm";const r=document.createElement("span");r.textContent=e.name,r.contentEditable="true",r.className="editable-name px-1 py-0.5 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",r.style.minHeight="1.5rem",r.style.display="inline-block";const s=document.createElement("button");return s.type="button",s.textContent="🗑️",s.className="btn-danger btn-match-input",n.appendChild(r),n.appendChild(s),t.appendChild(n),{element:t,editableName:r,deleteBtn:s}}function st({titleElement:e}){return()=>{e.style.padding="8px 12px",e.style.backgroundColor="",e.style.border="1px solid #dee2e6",setTimeout(()=>{const t=document.createRange(),n=window.getSelection();n&&(t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t))},0)}}function ot({titleElement:e,course:t,courseId:n,coursesUseCase:r,messages:s,timeouts:o}){return async()=>{if(e.dataset.saving==="true")return;e.style.transition="background-color 0.3s ease, color 0.3s ease",e.style.padding="",e.style.backgroundColor="",e.style.border="",e.style.color="";const a=e.textContent.trim();if(a&&a!==t.name)try{e.dataset.saving="true",e.contentEditable="false",await r.rename({id:n,newName:a}),t.name=a,e.style.backgroundColor="#22c55e",e.style.color="white",e.style.padding="8px 12px",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.style.padding="",e.contentEditable="true",e.dataset.saving="false"},500)}catch{e.textContent=t.name,e.style.backgroundColor="#ef4444",e.style.color="white",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.contentEditable="true",e.dataset.saving="false"},o.ERROR_FEEDBACK)}else a||(e.textContent=t.name)}}function at({titleElement:e,course:t}){return n=>{n.key==="Enter"?(n.preventDefault(),e.blur()):n.key==="Escape"&&(n.preventDefault(),e.textContent=t.name,e.blur())}}function ct({courseId:e,coursesUseCase:t,messages:n}){return async()=>{if(!window.confirm(n.CONFIRMATIONS.DELETE_COURSE))return;await t.remove({id:e})&&(location.hash="#/courses")}}function it({courseId:e,coursesUseCase:t,messages:n}){return async()=>{const r=await t.getById({id:e});if(!r||!r.students.length){alert(n.ERRORS.NO_STUDENTS_FOR_IMPRO);return}location.hash=`#/courses/${e}/impro`}}function lt({input:e,courseId:t,coursesUseCase:n,refreshStudents:r,updateGenerateImproButton:s}){return async()=>{const o=e.value.trim();o&&(await n.addStudent({courseId:t,studentName:o}),e.value="",r(),await s())}}function dt({editableElement:e,student:t,courseId:n,coursesUseCase:r,timeouts:s}){return{focusHandler:()=>{e.style.padding="4px 8px",e.style.backgroundColor="",e.style.border="1px solid #dee2e6",setTimeout(()=>{const i=document.createRange(),u=window.getSelection();u&&(i.selectNodeContents(e),i.collapse(!1),u.removeAllRanges(),u.addRange(i))},0)},blurHandler:async()=>{if(e.dataset.saving==="true")return;e.style.transition="background-color 0.3s ease, color 0.3s ease",e.style.padding="",e.style.backgroundColor="",e.style.border="",e.style.color="";const i=e.textContent.trim();if(i&&i!==t.name)try{e.dataset.saving="true",e.contentEditable="false",await r.renameStudent({courseId:n,studentId:t.id,newName:i}),t.name=i,e.style.backgroundColor="#22c55e",e.style.color="white",e.style.padding="8px 12px",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.style.padding="",e.contentEditable="true",e.dataset.saving="false"},500)}catch{e.textContent=t.name,e.style.backgroundColor="#ef4444",e.style.color="white",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.contentEditable="true",e.dataset.saving="false"},s.ERROR_FEEDBACK)}else i||(e.textContent=t.name)},keydownHandler:i=>{i.key==="Enter"?(i.preventDefault(),e.blur()):i.key==="Escape"&&(i.preventDefault(),e.textContent=t.name,e.blur())}}}function ut({student:e,courseId:t,coursesUseCase:n,refreshStudents:r,updateGenerateImproButton:s,messages:o}){return async()=>{if(!window.confirm(o.CONFIRMATIONS.DELETE_STUDENT(e.name)))return;await n.removeStudent({courseId:t,studentId:e.id})&&(r(),await s())}}async function mt({root:e,params:t,deps:n}){e.innerHTML="";const r=await n.coursesUseCase.getById({id:t.id});if(!r){const C=document.createElement("div");C.className="card text-center",C.innerHTML=`<p class="text-danger">${L.ERRORS.COURSE_NOT_FOUND}</p>`,e.appendChild(C);return}const s=document.createElement("div");s.className="card",s.style.position="relative",s.style.paddingTop="3rem";const o=document.createElement("a");o.href="#/courses",o.textContent=L.LABELS.BACK_TO_COURSES,o.className="btn-secondary btn-xs",o.style.position="absolute",o.style.top="0.5rem",o.style.right="0.5rem",o.style.zIndex="10",s.appendChild(o);const{section:a,title:c,deleteBtn:i}=et({course:r}),u=st({titleElement:c}),m=ot({titleElement:c,course:r,courseId:t.id,coursesUseCase:n.coursesUseCase,messages:L,timeouts:fe}),d=at({titleElement:c,course:r});if(c.addEventListener("focus",u),c.addEventListener("blur",m),c.addEventListener("keydown",d),i){const C=ct({courseId:t.id,coursesUseCase:n.coursesUseCase,messages:L});i.addEventListener("click",C)}s.appendChild(a);const{section:l,button:p}=tt({messages:L}),f=it({courseId:t.id,coursesUseCase:n.coursesUseCase,messages:L}),b=async C=>{if(p.disabled){C.preventDefault();return}await f()};p.addEventListener("click",b);async function h(){const C=await n.coursesUseCase.getById({id:t.id});!C||!C.students.length?(p.disabled=!0,p.className="btn-primary btn-lg rounded"):(p.disabled=!1,p.className="btn-primary btn-lg rounded")}await h(),s.appendChild(l);const{section:S,emptyMsg:w,list:_,form:H,input:z}=nt({messages:L}),j=lt({input:z,courseId:t.id,coursesUseCase:n.coursesUseCase,refreshStudents:B,updateGenerateImproButton:h}),J=async C=>{C.preventDefault(),await j()};H.addEventListener("submit",J);async function B(){const C=await n.coursesUseCase.getById({id:t.id});if(_.innerHTML="",!C||!C.students.length){w.textContent=L.LABELS.EMPTY_STUDENTS_MESSAGE;return}w.textContent="";for(const $ of C.students){const{element:I,editableName:M,deleteBtn:N}=rt({student:$}),{focusHandler:v,blurHandler:g,keydownHandler:x}=dt({editableElement:M,student:$,courseId:t.id,coursesUseCase:n.coursesUseCase,timeouts:fe});M.addEventListener("focus",v),M.addEventListener("blur",g),M.addEventListener("keydown",x);const A=ut({student:$,courseId:t.id,coursesUseCase:n.coursesUseCase,refreshStudents:B,updateGenerateImproButton:h,messages:L});N.addEventListener("click",A),_.appendChild(I)}}s.appendChild(S),e.appendChild(s),B()}function pt(){const e=document.createElement("button");return e.className="burger-btn",e.setAttribute("aria-label","Menu"),e.textContent="☰",e}function ft(){const e=document.createElement("nav");e.className="burger-panel",e.setAttribute("hidden","");const t=document.createElement("ul"),r=[{href:"#/courses",text:"Cours"},{href:"#/places",text:"Lieux"},{href:"#/moods",text:"Émotions"},{href:"#/characters",text:"Personnages"}].map(s=>{const o=document.createElement("li"),a=document.createElement("a");return a.href=s.href,a.textContent=s.text,o.appendChild(a),t.appendChild(o),a});return e.appendChild(t),{panel:e,list:t,links:r}}function gt(){return document.createElement("div")}function ht({button:e,panel:t}){return()=>{t.hasAttribute("hidden")?t.removeAttribute("hidden"):t.setAttribute("hidden","")}}function Ct({panel:e,links:t}){return n=>{if(n.target.tagName==="A"){if(yt()&&!window.confirm("Vous allez perdre l'impro générée. Continuer ?")){n.preventDefault();return}e.setAttribute("hidden","")}}}function xt({container:e,button:t,panel:n}){return r=>{const s=r.target;!n.hasAttribute("hidden")&&!e.contains(s)&&s!==t&&s!==n&&n.setAttribute("hidden","")}}function yt(){var t;const e=document.querySelector('.card[style*="display: block"]');return!!(e&&((t=e.querySelector("h3"))==null?void 0:t.textContent)==="Impro générée")}function Et({mountOn:e}){const t=gt(),n=pt(),{panel:r,links:s}=ft(),o=ht({button:n,panel:r}),a=Ct({panel:r,links:s}),c=xt({container:t,button:n,panel:r});n.addEventListener("click",o),r.addEventListener("click",a),document.addEventListener("click",c),t.appendChild(n),t.appendChild(r),e.appendChild(t)}const St={TRANSITION_DURATION:500,ERROR_FEEDBACK_DURATION:2e3},Nt={CONFIRMATIONS:{DELETE_ITEM:"Supprimer"},FEEDBACK:{SUCCESS_COLOR:"#22c55e",ERROR_COLOR:"#ef4444"}};function bt({title:e,placeholder:t,emptyMessage:n,createEmptyMessage:r}){const s=document.createElement("div");s.className="card";const o=document.createElement("h1");o.textContent=e,o.className="text-center mb-lg",s.appendChild(o);const a=document.createElement("form");a.className="flex gap-sm mb-lg";const c=document.createElement("input");c.type="text",c.placeholder=t,c.required=!0,c.name="itemName";const i=document.createElement("button");i.type="submit",i.textContent="+",i.className="btn-secondary btn-match-input",a.appendChild(c),a.appendChild(i),s.appendChild(a);const u=r({text:n});s.appendChild(u);const m=document.createElement("div");return m.className="flex flex-col gap-sm",s.appendChild(m),{container:s,form:a,input:c,emptyMsg:u,list:m}}function vt({editableElement:e}){return()=>{e.style.padding="8px 12px",e.style.backgroundColor="",e.style.border="1px solid #dee2e6",setTimeout(()=>{const t=document.createRange(),n=window.getSelection();n&&(t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t))},0)}}function At({editableElement:e,initialValue:t,itemId:n,useCase:r,onSuccess:s,timeouts:o,colors:a}){return async c=>{if(e.dataset.saving!=="true")if(e.style.transition="background-color 0.3s ease, color 0.3s ease",e.style.padding="4px 8px",e.style.backgroundColor="",e.style.border="",e.style.color="",c&&c!==t)try{e.dataset.saving="true",e.contentEditable="false",await r.rename({id:n,newName:c}),e.style.backgroundColor=a.SUCCESS_COLOR,e.style.color="white",e.style.padding="8px 12px",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.style.padding="",e.contentEditable="true",e.dataset.saving="false"},o.TRANSITION_DURATION),s()}catch{e.textContent=t,e.style.backgroundColor=a.ERROR_COLOR,e.style.color="white",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.contentEditable="true",e.dataset.saving="false"},o.ERROR_FEEDBACK_DURATION)}else c||(e.textContent=t)}}function It({editableElement:e,initialValue:t}){return n=>{n.key==="Enter"?(n.preventDefault(),e.blur()):n.key==="Escape"&&(n.preventDefault(),e.textContent=t,e.blur())}}function Tt({input:e,useCase:t,onSuccess:n}){return async()=>{const r=e.value.trim();r&&(await t.create({name:r}),e.value="",n())}}function Lt({formSubmitHandler:e}){return async t=>{t.preventDefault(),await e()}}function Rt({editableElement:e,blurHandler:t}){return()=>t(e.textContent.trim())}function wt({onClick:e}){const t=document.createElement("button");return t.type="button",t.textContent="🗑️",t.className="btn-danger btn-match-input",t.addEventListener("click",e),t}function Ot({item:e,editableElement:t,deleteButton:n}){const r=document.createElement("div");r.className="card",r.style.padding="0.5rem 0.75rem",r.style.minHeight="auto";const s=document.createElement("div");return s.className="flex items-center justify-between gap-sm",s.appendChild(t),s.appendChild(n),r.appendChild(s),r}function Ut({text:e,className:t="text-center text-muted mb-md"}){const n=document.createElement("p");return n.className=t,n.textContent=e,n}function ce({root:e,config:t}){e.innerHTML="";let n=[];function r({item:l}){let p=l.name;const f=document.createElement("span");f.textContent=p,f.contentEditable="true",f.className="editable-name px-1 py-0.5 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",f.style.minHeight="1.5rem",f.style.display="inline-block";const b=wt({onClick:async()=>{if(!window.confirm(`Supprimer ${t.entityName} "${l.name}" ?`))return;await t.useCase.remove({id:l.id})&&s()}}),h=vt({editableElement:f}),S=At({editableElement:f,initialValue:p,itemId:l.id,useCase:t.useCase,onSuccess:s,timeouts:St,colors:Nt.FEEDBACK}),w=It({editableElement:f,initialValue:p}),_=Rt({editableElement:f,blurHandler:S});return f.addEventListener("focus",h),f.addEventListener("blur",_),f.addEventListener("keydown",w),Ot({item:l,editableElement:f,deleteButton:b})}async function s(){if(n=await t.useCase.list(),u.innerHTML="",!n.length)i.textContent=t.emptyMessage;else{i.textContent="";for(const l of n){const p=r({item:l});u.appendChild(p)}}}const{container:o,form:a,input:c,emptyMsg:i,list:u}=bt({title:t.title,placeholder:t.placeholder,emptyMessage:t.emptyMessage,createEmptyMessage:Ut}),m=Tt({input:c,useCase:t.useCase,onSuccess:s}),d=Lt({formSubmitHandler:m});a.addEventListener("submit",d),e.appendChild(o),s()}function Pt({root:e,deps:t}){ce({root:e,config:{title:"Lieux",placeholder:"Nom du lieu",emptyMessage:"Ajoutez votre premier lieu",entityName:"le lieu",useCase:t.placesUseCase}})}function _t({root:e,deps:t}){ce({root:e,config:{title:"Émotions",placeholder:"Nom de l'émotion",emptyMessage:"Ajoutez votre première émotion",entityName:"l'émotion",useCase:t.moodsUseCase}})}function Mt({root:e,deps:t}){ce({root:e,config:{title:"Personnages",placeholder:"Nom du personnage",emptyMessage:"Ajoutez votre premier personnage",entityName:"le personnage",useCase:t.charactersUseCase}})}function ge({course:e,selectedStudents:t,onToggle:n,onSelectAll:r,createStudentCard:s}){const o=document.createElement("div");o.className="mb-md";const a=document.createElement("h3");a.textContent="Sélectionner les élèves",a.className="mb-sm text-base",o.appendChild(a);const c=document.createElement("button");c.type="button",c.textContent=t.size===e.students.length&&e.students.length>0?"Tout dé-sélectionner":"Tout sélectionner",c.className="btn-secondary btn-sm mb-sm",o.appendChild(c);const i=document.createElement("div");return i.className="flex flex-col gap-xs max-h-48 overflow-y-auto",e.students.forEach(u=>{const m=s(u,t.has(u.id),n);i.appendChild(m)}),o.appendChild(i),{section:o,selectAllBtn:c}}function he({placesCount:e,onPlacesCountChange:t,maxPlaces:n}){const r=document.createElement("div");r.className="mb-md";const s=document.createElement("label");s.textContent="Nombre de lieux: ",s.className="font-medium mb-xs block text-sm";const o=document.createElement("div");o.className="flex items-center gap-sm";const a=document.createElement("button");a.type="button",a.textContent="-",a.className="btn-secondary btn-match-input",a.disabled=e<=1;const c=document.createElement("input");c.type="number",c.min="1",c.max=n.toString(),c.value=e.toString(),c.className="w-auto text-center",c.style.width="80px";const i=document.createElement("button");return i.type="button",i.textContent="+",i.className="btn-secondary btn-match-input",i.disabled=e>=n,o.appendChild(a),o.appendChild(c),o.appendChild(i),s.appendChild(o),r.appendChild(s),{section:r,decrementBtn:a,placesInput:c,incrementBtn:i}}function Dt({places:e,onRegenerate:t,onDelete:n}){const r=document.createElement("div");r.className="flex flex-col gap-xs mb-md";const s=[],o=[];return e.forEach((a,c)=>{const i=document.createElement("div");i.className="card p-sm";const u=document.createElement("div");u.className="inline-edit-container";const m=document.createElement("span");m.textContent=a.name,m.className="font-medium text-sm";const d=document.createElement("div");d.className="btn-group";const l=document.createElement("button");l.type="button",l.textContent="🔄",l.className="btn-secondary btn-compact";const p=document.createElement("button");p.type="button",p.textContent="🗑️",p.className="btn-danger btn-compact",p.disabled=e.length<=1,d.appendChild(l),d.appendChild(p),u.appendChild(m),u.appendChild(d),i.appendChild(u),r.appendChild(i),s.push(l),o.push(p)}),{list:r,regenerateButtons:s,deleteButtons:o}}function kt({assignments:e}){const t=document.createElement("div");t.className="flex flex-col gap-xs";const n=[],r=[],s=[];return e.forEach((o,a)=>{const c=document.createElement("div");c.className="card p-sm";const i=document.createElement("div");i.className="text-base font-semibold mb-xs",i.textContent=o.student.name,c.appendChild(i);const u=document.createElement("div");u.className="flex justify-between items-center mb-xs";const m=document.createElement("span");m.textContent=o.character.name,m.className="font-medium text-sm";const d=document.createElement("button");d.type="button",d.textContent="🔄",d.className="btn-secondary btn-match-input",u.appendChild(m),u.appendChild(d),c.appendChild(u);const l=document.createElement("div");l.className="flex justify-between items-center mb-xs";const p=document.createElement("span");p.textContent=o.mood.name,p.className="text-secondary text-sm";const f=document.createElement("button");f.type="button",f.textContent="🔄",f.className="btn-secondary btn-match-input",l.appendChild(p),l.appendChild(f),c.appendChild(l);const b=document.createElement("div");b.className="flex justify-end mt-xs";const h=document.createElement("button");h.type="button",h.textContent="🗑️ Supprimer l'élève de l'impro",h.className="btn-danger btn-sm",h.disabled=e.length<=1,b.appendChild(h),c.appendChild(b),t.appendChild(c),n.push(d),r.push(f),s.push(h)}),{list:t,regenerateCharacterButtons:n,regenerateMoodButtons:r,deleteStudentButtons:s}}function Ce({studentId:e,selectedStudents:t,onUpdate:n}){return()=>{t.has(e)?t.delete(e):t.add(e),n()}}function Y({course:e,selectedStudents:t,onUpdate:n}){return()=>{t.size===e.students.length?t.clear():(t.clear(),e.students.forEach(r=>t.add(r.id))),n()}}function Ht({selectedStudents:e,getPlacesCount:t,course:n,deps:r,onImproGenerated:s,messages:o}){return async()=>{const a=r.validationUseCase.validateStudentSelection({selectedStudents:e,course:n});if(a){alert(a);return}const c=await r.placesUseCase.list(),i=t(),u=r.validationUseCase.validatePlacesCount({placesCount:i,availablePlaces:c.length});if(u){alert(u);return}try{const m=n.students.filter(l=>e.has(l.id)),d=await r.improGenerationUseCase.generate({students:m,placesCount:i});s(d)}catch(m){alert(`${o.ERRORS.GENERATION_FAILED}: ${m.message}`)}}}function xe({places:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{try{const o=await n.regenerationUseCase.regeneratePlace({currentPlaces:e,placeIndex:t});e[t]=o,r()}catch(o){alert(`${s.ERRORS.REGENERATION_FAILED}: ${o.message}`)}}}function ye({places:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{const o=e[t].name;await n.deletionUseCase.confirmDeletion({confirmationMessage:s.CONFIRMATIONS.DELETE_PLACE(o)})&&(e.splice(t,1),r())}}function Bt({assignments:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{try{const o=await n.regenerationUseCase.regenerateCharacter({currentAssignments:e,assignmentIndex:t});e[t].character=o,r()}catch(o){alert(`${s.ERRORS.REGENERATION_FAILED}: ${o.message}`)}}}function $t({assignments:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{try{const o=await n.regenerationUseCase.regenerateMood({currentAssignments:e,assignmentIndex:t});e[t].mood=o,r()}catch(o){alert(`${s.ERRORS.REGENERATION_FAILED}: ${o.message}`)}}}function Ft({assignments:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{const o=e[t].student.name;await n.deletionUseCase.confirmDeletion({confirmationMessage:s.CONFIRMATIONS.DELETE_STUDENT(o)})&&(e.splice(t,1),r())}}function Gt({getHasGeneratedImpro:e,messages:t}){return n=>{e()&&(window.confirm(t.CONFIRMATIONS.NAVIGATE_AWAY)||n.preventDefault())}}const zt={DEFAULT_PLACES_COUNT:1},E={ERRORS:{NO_STUDENTS_SELECTED:"Sélectionnez au moins un élève",TOO_MANY_STUDENTS:"Trop d'élèves sélectionnés",INVALID_PLACES_COUNT:"Nombre de lieux invalide",NO_PLACES_AVAILABLE:"Aucun lieu disponible",NO_CHARACTERS_AVAILABLE:"Aucun personnage disponible",NO_MOODS_AVAILABLE:"Aucune émotion disponible",NOT_ENOUGH_CHARACTERS:"Pas assez de personnages pour tous les élèves",NOT_ENOUGH_PLACES:"Pas assez de lieux disponibles",GENERATION_FAILED:"Erreur lors de la génération de l'impro",REGENERATION_FAILED:"Erreur lors de la régénération",DELETION_FAILED:"Erreur lors de la suppression"},CONFIRMATIONS:{DELETE_PLACE:e=>`Supprimer le lieu "${e}" de l'impro ?`,DELETE_STUDENT:e=>`Supprimer l'élève "${e}" de l'impro ?`,NAVIGATE_AWAY:"Vous allez perdre l'impro générée. Continuer ?"},SUCCESS:{IMPRO_GENERATED:"Impro générée avec succès",ELEMENT_REGENERATED:"Élément régénéré avec succès",ELEMENT_DELETED:"Élément supprimé avec succès"},LABELS:{STUDENT_SELECTION:"Sélectionner les élèves",PLACES_COUNT:"Nombre de lieux: ",GENERATE_IMPRO:"🎭 Générer une impro",SELECT_ALL:"Tout sélectionner",DESELECT_ALL:"Tout dé-sélectionner",PLACES_TITLE:"Lieux:",ASSIGNMENTS_TITLE:"Attributions:",IMPRO_GENERATED_TITLE:"Impro générée"}};function Ee({student:e,isSelected:t,onToggle:n}){const r=document.createElement("div");r.className="card p-sm";const s=document.createElement("label");s.className="flex items-center gap-xs cursor-pointer w-full";const o=document.createElement("input");o.type="checkbox",o.value=e.id,o.checked=t;const a=()=>{n(e.id)};return o.addEventListener("change",a),s.appendChild(o),s.appendChild(document.createTextNode(e.name)),r.appendChild(s),r}async function jt({root:e,params:t,deps:n}){e.innerHTML="";const r=await n.coursesUseCase.getById({id:t.courseId});if(!r){const g=document.createElement("div");g.className="card text-center",g.innerHTML='<p class="text-danger">Cours introuvable</p>',e.appendChild(g);return}let s=new Set,o=zt.DEFAULT_PLACES_COUNT,a=!1,c=null,i=1;i=(await n.placesUseCase.list()).length;const m=r,d=document.createElement("div");d.className="card",d.style.position="relative",d.style.paddingTop="3rem";const l=document.createElement("a");l.href=`#/courses/${t.courseId}`,l.textContent="← Retour au cours",l.className="btn-secondary btn-xs",l.style.position="absolute",l.style.top="0.5rem",l.style.right="0.5rem",l.style.zIndex="10";const p=Gt({getHasGeneratedImpro:()=>a,messages:E});l.addEventListener("click",p),d.appendChild(l);const f=document.createElement("div");f.className="flex justify-center items-center mb-md";const b=document.createElement("h1");b.textContent=`Impro : ${m.name}`,b.className="mb-0 text-lg",f.appendChild(b),d.appendChild(f);function h(){const g=d.querySelector(".student-selection-section");g&&g.remove();const{section:x,selectAllBtn:A}=ge({course:m,selectedStudents:s,onToggle:O=>Ce({studentId:O,selectedStudents:s,onUpdate:h})(),onSelectAll:Y({course:m,selectedStudents:s,onUpdate:h}),createStudentCard:(O,D,U)=>Ee({student:O,isSelected:D,onToggle:U})});x.className+=" student-selection-section",A.addEventListener("click",Y({course:m,selectedStudents:s,onUpdate:h})),d.insertBefore(x,d.querySelector(".places-section")),I.disabled=s.size===0}function S(g){o=g;const x=d.querySelector(".places-section");x&&x.remove();const{section:A,decrementBtn:O,placesInput:D,incrementBtn:U}=he({placesCount:o,onPlacesCountChange:S,maxPlaces:i});A.className+=" places-section";const W=()=>{o>1&&S(o-1)},Z=()=>{const X=parseInt(D.value)||1,y=Math.max(1,Math.min(i,X));S(y)},Q=()=>{o<i&&S(o+1)};O.addEventListener("click",W),D.addEventListener("input",Z),U.addEventListener("click",Q),d.insertBefore(A,I)}const{section:w,selectAllBtn:_}=ge({course:m,selectedStudents:s,onToggle:g=>Ce({studentId:g,selectedStudents:s,onUpdate:h})(),onSelectAll:Y({course:m,selectedStudents:s,onUpdate:h}),createStudentCard:(g,x,A)=>Ee({student:g,isSelected:x,onToggle:A})});w.className+=" student-selection-section",_.addEventListener("click",Y({course:m,selectedStudents:s,onUpdate:h})),d.appendChild(w);const{section:H,decrementBtn:z,placesInput:j,incrementBtn:J}=he({placesCount:o,onPlacesCountChange:S,maxPlaces:i});H.className+=" places-section";const B=()=>{o>1&&S(o-1)},C=()=>{const g=parseInt(j.value)||1,x=Math.max(1,Math.min(i,g));S(x)},$=()=>{o<i&&S(o+1)};z.addEventListener("click",B),j.addEventListener("input",C),J.addEventListener("click",$),d.appendChild(H);const I=document.createElement("button");I.textContent=E.LABELS.GENERATE_IMPRO,I.className="btn-primary btn-lg mb-md",I.disabled=!0;const M=Ht({selectedStudents:s,getPlacesCount:()=>o,course:m,deps:n,onImproGenerated:g=>{c=g,a=!0,v()},messages:E});I.addEventListener("click",M),d.appendChild(I);const N=document.createElement("div");N.className="card",N.style.display="none",d.appendChild(N),e.appendChild(d);function v(){if(!c)return;N.style.display="block",N.innerHTML="";const g=document.createElement("h3");g.textContent=E.LABELS.IMPRO_GENERATED_TITLE,g.className="text-center mb-md text-lg",N.appendChild(g);const x=document.createElement("h4");x.textContent=E.LABELS.PLACES_TITLE,x.className="mb-sm text-base",N.appendChild(x);const{list:A,regenerateButtons:O,deleteButtons:D}=Dt({places:c.places,onRegenerate:y=>xe({places:c.places,index:y,deps:n,onUpdate:v,messages:E})(),onDelete:y=>ye({places:c.places,index:y,deps:n,onUpdate:v,messages:E})()});O.forEach((y,T)=>{y.addEventListener("click",()=>xe({places:c.places,index:T,deps:n,onUpdate:v,messages:E})())}),D.forEach((y,T)=>{y.addEventListener("click",()=>ye({places:c.places,index:T,deps:n,onUpdate:v,messages:E})())}),N.appendChild(A);const U=document.createElement("h4");U.textContent=E.LABELS.ASSIGNMENTS_TITLE,U.className="mb-sm text-base",N.appendChild(U);const{list:W,regenerateCharacterButtons:Z,regenerateMoodButtons:Q,deleteStudentButtons:X}=kt({assignments:c.assignments});Z.forEach((y,T)=>{y.addEventListener("click",()=>Bt({assignments:c.assignments,index:T,deps:n,onUpdate:v,messages:E})())}),Q.forEach((y,T)=>{y.addEventListener("click",()=>$t({assignments:c.assignments,index:T,deps:n,onUpdate:v,messages:E})())}),X.forEach((y,T)=>{y.addEventListener("click",()=>Ft({assignments:c.assignments,index:T,deps:n,onUpdate:v,messages:E})())}),N.appendChild(W)}}try{const e=Le();e.success&&e.migratedKeys.length>0&&console.log(`✅ Migration réussie: ${e.totalItems} éléments migrés`)}catch(e){console.error("❌ Erreur lors de la migration des données:",e)}"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{const e=await navigator.serviceWorker.ready;console.log("Service worker ready:",e.scope)}catch{console.log("Service worker not ready yet")}});const P=document.getElementById("app");if(P){const e=Ke(),t=document.getElementById("menu");t&&Et({mountOn:t}),new Ve([{path:"/courses",handler:()=>Xe({root:P,deps:e})},{path:"/courses/:id",handler:r=>mt({root:P,params:r,deps:e})},{path:"/courses/:courseId/impro",handler:r=>jt({root:P,params:r,deps:e})},{path:"/places",handler:()=>Pt({root:P,deps:e})},{path:"/moods",handler:()=>_t({root:P,deps:e})},{path:"/characters",handler:()=>Mt({root:P,deps:e})}]).start()}
