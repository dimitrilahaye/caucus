var te=e=>{throw TypeError(e)};var V=(e,t,n)=>t.has(e)||te("Cannot "+n);var ne=(e,t,n)=>(V(e,t,"read from private field"),n?n.call(e):t.get(e)),Y=(e,t,n)=>t.has(e)?te("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),re=(e,t,n,r)=>(V(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),J=(e,t,n)=>(V(e,t,"access private method"),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Ce={"cre-impro~characters":"caucus~characters","cre-impro~courses":"caucus~courses","cre-impro~moods":"caucus~moods","cre-impro~places":"caucus~places"};function ve(){return Object.keys(Ce).some(e=>localStorage.getItem(e)!==null)}function Ae({oldKey:e,newKey:t}){try{const n=localStorage.getItem(e);return n===null?!0:localStorage.getItem(t)!==null?(console.warn(`Migration: Les donn√©es ${t} existent d√©j√†, suppression de ${e}`),localStorage.removeItem(e),!0):(localStorage.setItem(t,n),localStorage.removeItem(e),console.log(`Migration: ${e} ‚Üí ${t} (${n.length} caract√®res)`),!0)}catch(n){return console.error(`Erreur lors de la migration ${e} ‚Üí ${t}:`,n),!1}}function Ie(){const e={success:!0,migratedKeys:[],errors:[],totalItems:0};if(!ve())return console.log("Migration: Aucune donn√©e ancienne trouv√©e, migration non n√©cessaire"),e;console.log("Migration: D√©but de la migration des donn√©es LocalStorage...");for(const[t,n]of Object.entries(Ce))if(Ae({oldKey:t,newKey:n})){e.migratedKeys.push(`${t} ‚Üí ${n}`);try{const s=localStorage.getItem(n);if(s){const o=JSON.parse(s);Array.isArray(o)&&(e.totalItems+=o.length)}}catch{}}else e.success=!1,e.errors.push(`√âchec de la migration ${t} ‚Üí ${n}`);return e.success?console.log(`Migration: Succ√®s! ${e.migratedKeys.length} cl√©s migr√©es, ${e.totalItems} √©l√©ments au total`):console.error("Migration: √âchec partiel:",e.errors),e}const xe="caucus~courses";function P(){const e=localStorage.getItem(xe);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function M({courses:e}){localStorage.setItem(xe,JSON.stringify(e))}function se(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Te(){return{async list(){return P()},async create({name:e}){const t=P(),n={id:se(),name:e,students:[]};return M({courses:[n,...t]}),n},async getById({id:e}){return P().find(n=>n.id===e)||void 0},async rename({id:e,newName:t}){const n=P(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},M({courses:n}),n[r]},async remove({id:e}){const t=P(),n=t.length,r=t.filter(s=>s.id!==e);return M({courses:r}),r.length!==n},async addStudent({courseId:e,studentName:t}){const n=P(),r=n.findIndex(o=>o.id===e);if(r===-1)return;const s={id:se(),name:t};return n[r]={...n[r],students:[...n[r].students,s]},M({courses:n}),n[r]},async renameStudent({courseId:e,studentId:t,newName:n}){const r=P(),s=r.findIndex(i=>i.id===e);if(s===-1)return;const o=r[s].students.findIndex(i=>i.id===t);if(o===-1)return;const c={...r[s].students[o],name:n},a=r[s].students.slice();return a[o]=c,r[s]={...r[s],students:a},M({courses:r}),r[s]},async removeStudent({courseId:e,studentId:t}){const n=P(),r=n.findIndex(c=>c.id===e);if(r===-1)return!1;const s=n[r].students.length,o=n[r].students.filter(c=>c.id!==t);return n[r]={...n[r],students:o},M({courses:n}),o.length!==s}}}const ye="caucus~places";function $(){const e=localStorage.getItem(ye);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function W({places:e}){localStorage.setItem(ye,JSON.stringify(e))}function Le(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Re(){return{async list(){return $()},async create({name:e}){const t=$(),n={id:Le(),name:e};return W({places:[n,...t]}),n},async rename({id:e,newName:t}){const n=$(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},W({places:n}),n[r]},async remove({id:e}){const t=$(),n=t.length,r=t.filter(s=>s.id!==e);return W({places:r}),r.length!==n}}}const Ee="caucus~moods";function F(){const e=localStorage.getItem(Ee);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function Z({moods:e}){localStorage.setItem(Ee,JSON.stringify(e))}function we(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Oe(){return{async list(){return F()},async create({name:e}){const t=F(),n={id:we(),name:e};return Z({moods:[n,...t]}),n},async rename({id:e,newName:t}){const n=F(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},Z({moods:n}),n[r]},async remove({id:e}){const t=F(),n=t.length,r=t.filter(s=>s.id!==e);return Z({moods:r}),r.length!==n}}}const Se="caucus~characters";function G(){const e=localStorage.getItem(Se);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function Q({characters:e}){localStorage.setItem(Se,JSON.stringify(e))}function Ue(){return crypto&&"randomUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Pe(){return{async list(){return G()},async create({name:e}){const t=G(),n={id:Ue(),name:e};return Q({characters:[n,...t]}),n},async rename({id:e,newName:t}){const n=G(),r=n.findIndex(s=>s.id===e);if(r!==-1)return n[r]={...n[r],name:t},Q({characters:n}),n[r]},async remove({id:e}){const t=G(),n=t.length,r=t.filter(s=>s.id!==e);return Q({characters:r}),r.length!==n}}}function _e(){return{nextFloat(){return Math.random()}}}function Me({deps:e}){return{async list(){return await e.coursesPort.list()},async getById({id:t}){return await e.coursesPort.getById({id:t})},async create({name:t}){return await e.coursesPort.create({name:t})},async rename({id:t,newName:n}){return await e.coursesPort.rename({id:t,newName:n})},async remove({id:t}){return await e.coursesPort.remove({id:t})},async addStudent({courseId:t,studentName:n}){return await e.coursesPort.addStudent({courseId:t,studentName:n})},async renameStudent({courseId:t,studentId:n,newName:r}){return await e.coursesPort.renameStudent({courseId:t,studentId:n,newName:r})},async removeStudent({courseId:t,studentId:n}){return await e.coursesPort.removeStudent({courseId:t,studentId:n})}}}function De({deps:e}){return{async list(){return await e.placesPort.list()},async create({name:t}){return await e.placesPort.create({name:t})},async rename({id:t,newName:n}){return await e.placesPort.rename({id:t,newName:n})},async remove({id:t}){return await e.placesPort.remove({id:t})}}}function ke({deps:e}){return{async list(){return await e.moodsPort.list()},async create({name:t}){return await e.moodsPort.create({name:t})},async rename({id:t,newName:n}){return await e.moodsPort.rename({id:t,newName:n})},async remove({id:t}){return await e.moodsPort.remove({id:t})}}}function Be({deps:e}){return{async list(){return await e.charactersPort.list()},async create({name:t}){return await e.charactersPort.create({name:t})},async rename({id:t,newName:n}){return await e.charactersPort.rename({id:t,newName:n})},async remove({id:t}){return await e.charactersPort.remove({id:t})}}}function He({deps:e}){return{async generate({students:t,placesCount:n}){if(!t.length)throw new Error("Aucun √©l√®ve s√©lectionn√©");const[r,s,o]=await Promise.all([e.charactersPort.list(),e.moodsPort.list(),e.placesPort.list()]);if(r.length<t.length)throw new Error(`Pas assez de personnages (${r.length}) pour ${t.length} √©l√®ves`);if(!s.length)throw new Error("Aucune √©motion disponible");if(!o.length)throw new Error("Aucun lieu disponible");if(o.length<n){const l=n-o.length;throw new Error(`Il manque ${l} lieu${l>1?"x":""} pour satisfaire la demande (${o.length} disponible${o.length>1?"s":""}, ${n} demand√©${n>1?"s":""})`)}const c=[...r],a=[...s],i=[...o];for(let l=c.length-1;l>0;l--){const p=Math.floor(e.randomPort.nextFloat()*(l+1));[c[l],c[p]]=[c[p],c[l]]}for(let l=a.length-1;l>0;l--){const p=Math.floor(e.randomPort.nextFloat()*(l+1));[a[l],a[p]]=[a[p],a[l]]}for(let l=i.length-1;l>0;l--){const p=Math.floor(e.randomPort.nextFloat()*(l+1));[i[l],i[p]]=[i[p],i[l]]}const m=t.map((l,p)=>({student:l,character:c[p],mood:a[p%a.length]})),d=Math.min(n,i.length),u=i.slice(0,d);return{assignments:m,places:u}}}}function $e(){return{validateStudentSelection({selectedStudents:e,course:t}){return e.size===0?"S√©lectionnez au moins un √©l√®ve":e.size>t.students.length?"Trop d'√©l√®ves s√©lectionn√©s":null},validatePlacesCount({placesCount:e,availablePlaces:t}){return e<1?"Au moins un lieu est requis":e>t?`Maximum ${t} lieu${t>1?"x":""} disponible${t>1?"s":""}`:null}}}function Fe({deps:e}){return{async regeneratePlace({currentPlaces:t,placeIndex:n}){const r=await e.placesPort.list(),s=t.map(i=>i.id),o=t[n].id,c=r.filter(i=>!s.includes(i.id)&&i.id!==o);if(c.length===0)throw new Error("Aucun autre lieu disponible");const a=Math.floor(e.randomPort.nextFloat()*c.length);return c[a]},async regenerateCharacter({currentAssignments:t,assignmentIndex:n}){const r=await e.charactersPort.list(),s=t.map(i=>i.character.id),o=t[n].character.id,c=r.filter(i=>!s.includes(i.id)&&i.id!==o);if(c.length===0)throw new Error("Aucun autre personnage disponible");const a=Math.floor(e.randomPort.nextFloat()*c.length);return c[a]},async regenerateMood({currentAssignments:t,assignmentIndex:n}){const r=await e.moodsPort.list();if(r.length===0)throw new Error("Aucune √©motion disponible");const s=t[n].mood.id,o=r.filter(a=>a.id!==s);if(o.length===0)throw new Error("Aucune autre √©motion disponible");const c=Math.floor(e.randomPort.nextFloat()*o.length);return o[c]}}}function Ge(){return{async confirmDeletion({confirmationMessage:e}){return window.confirm(e)}}}function ze(){const e=_e(),t=Te(),n=Re(),r=Oe(),s=Pe();return{coursesUseCase:Me({deps:{coursesPort:t}}),placesUseCase:De({deps:{placesPort:n}}),moodsUseCase:ke({deps:{moodsPort:r}}),charactersUseCase:Be({deps:{charactersPort:s}}),improGenerationUseCase:He({deps:{charactersPort:s,moodsPort:r,placesPort:n,randomPort:e}}),validationUseCase:$e(),regenerationUseCase:Fe({deps:{placesPort:n,charactersPort:s,moodsPort:r,randomPort:e}}),deletionUseCase:Ge()}}function je({path:e,handler:t}){const n=[],r=e.replace(/\//g,"\\/").replace(/:([A-Za-z0-9_]+)/g,(o,c)=>(n.push(c),"([^/]+)"));return{pattern:new RegExp("^"+r+"$"),keys:n,handler:t}}var k,B,X;class Ke{constructor(t){Y(this,B);Y(this,k,[]);re(this,k,t.map(n=>je({path:n.path,handler:n.handler})))}start(){window.addEventListener("hashchange",()=>J(this,B,X).call(this)),location.hash?J(this,B,X).call(this):location.hash="#/courses"}}k=new WeakMap,B=new WeakSet,X=function(){const t=location.hash.replace(/^#/,"");for(const n of ne(this,k)){const r=t.match(n.pattern);if(r){const s={};n.keys.forEach((o,c)=>s[o]=decodeURIComponent(r[c+1])),n.handler(s);return}}};function qe({courses:e,onSubmitHandler:t,createCourseCard:n,createCourseForm:r,createMessage:s}){const o=document.createElement("div");o.className="card";const c=document.createElement("h1");c.textContent="Cours",c.className="text-center mb-lg",o.appendChild(c);const a=r({onSubmitHandler:t});o.appendChild(a);const i=s({text:e.length===0?"Cr√©ez votre premier cours":""});o.appendChild(i);const m=document.createElement("div");return m.className="flex flex-col gap-sm",e.forEach(d=>{const u=n({course:d});m.appendChild(u)}),o.appendChild(m),o}function Ve({courses:e,createCourseCard:t}){const n=document.createElement("div");return n.className="flex flex-col gap-sm",e.forEach(r=>{const s=t({course:r});n.appendChild(s)}),n}function Ye({courses:e,createMessage:t}){const n=e.length===0?"Cr√©ez votre premier cours":"";return t({text:n})}function Je({coursesUseCase:e,onRefresh:t}){return async n=>{n.preventDefault();const s=n.target.querySelector('input[name="courseName"]'),o=s.value.trim();if(o)try{await e.create({name:o}),s.value="",await t()}catch(c){console.error("Erreur lors de la cr√©ation du cours:",c)}}}function oe({course:e}){const t=document.createElement("a");t.href=`#/courses/${encodeURIComponent(e.id)}`,t.className="card-compact cursor-pointer",t.style.display="block",t.style.textDecoration="none",t.style.color="inherit";const n=document.createElement("div");return n.textContent=e.name,n.className="text-base font-medium",t.appendChild(n),t}function We({onSubmitHandler:e}){const t=document.createElement("form");t.className="flex gap-sm mb-lg";const n=document.createElement("input");n.type="text",n.placeholder="Nom du cours",n.required=!0,n.name="courseName";const r=document.createElement("button");return r.type="submit",r.textContent="+",r.className="btn-secondary btn-match-input",t.appendChild(n),t.appendChild(r),t.addEventListener("submit",e),t}function ae({text:e,className:t="text-center text-muted mb-md"}){const n=document.createElement("p");return n.textContent=e,n.className=t,n}function Ze({root:e,deps:t}){e.innerHTML="";let n=[];async function r(){try{n=await t.coursesUseCase.list(),s()}catch(a){console.error("Erreur lors du chargement des cours:",a)}}function s(){const a=e.querySelector(".card");if(!a)return;const i=a.querySelector(".courses-list");i&&i.remove();const m=Ve({courses:n,createCourseCard:oe});m.className+=" courses-list",a.appendChild(m);const d=a.querySelector(".courses-message");d&&d.remove();const u=Ye({courses:n,createMessage:ae});u.className+=" courses-message",a.appendChild(u)}const o=Je({coursesUseCase:t.coursesUseCase,onRefresh:r}),c=qe({courses:n,onSubmitHandler:o,createCourseCard:oe,createCourseForm:We,createMessage:ae});e.appendChild(c),r()}const O={ERRORS:{COURSE_NOT_FOUND:"Cours introuvable",NO_STUDENTS_FOR_IMPRO:"Il faut au moins un √©l√®ve pour g√©n√©rer une impro"},CONFIRMATIONS:{DELETE_COURSE:"Supprimer ce cours et tous ses √©l√®ves ?",DELETE_STUDENT:e=>`Supprimer l'√©l√®ve "${e}" ?`},LABELS:{BACK_TO_COURSES:"‚Üê Retour √† la liste des cours",GENERATE_IMPRO:"üé≠ G√©n√©rer une impro",STUDENTS_TITLE:"√âl√®ves",STUDENT_NAME_PLACEHOLDER:"Nom de l'√©l√®ve",EMPTY_STUDENTS_MESSAGE:"Ajoutez votre premier √©l√®ve pour ce cours"}},ce={ERROR_FEEDBACK:2e3};function Qe({course:e}){const t=document.createElement("div");t.className="flex justify-between items-center mb-lg";const n=document.createElement("h1");n.textContent=e.name,n.contentEditable="true",n.className="mb-0 px-2 py-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",n.style.minHeight="2rem",n.style.display="inline-flex",n.style.alignItems="center",n.style.marginBottom="0";const r=document.createElement("button");return r.type="button",r.textContent="üóëÔ∏è",r.className="btn-danger btn-match-input",t.appendChild(n),t.appendChild(r),{section:t,title:n,deleteBtn:r}}function Xe({messages:e}){const t=document.createElement("div");t.className="mb-lg";const n=document.createElement("button");return n.type="button",n.textContent=e.LABELS.GENERATE_IMPRO,n.className="btn-primary btn-lg rounded",t.appendChild(n),{section:t,button:n}}function et({messages:e}){const t=document.createElement("div");t.className="mb-lg";const n=document.createElement("h3");n.textContent=e.LABELS.STUDENTS_TITLE,n.className="mb-md",t.appendChild(n);const r=document.createElement("form");r.className="flex gap-sm mb-md";const s=document.createElement("input");s.type="text",s.placeholder=e.LABELS.STUDENT_NAME_PLACEHOLDER,s.required=!0,s.name="studentName";const o=document.createElement("button");o.type="submit",o.textContent="+",o.className="btn-secondary btn-match-input",r.appendChild(s),r.appendChild(o),t.appendChild(r);const c=document.createElement("p");c.className="text-center text-muted mb-md",t.appendChild(c);const a=document.createElement("div");return a.className="flex flex-col gap-sm",t.appendChild(a),{section:t,emptyMsg:c,list:a,form:r,input:s}}function tt({student:e}){const t=document.createElement("div");t.className="card",t.style.padding="0.5rem 0.75rem",t.style.minHeight="auto";const n=document.createElement("div");n.className="flex items-center justify-between gap-sm";const r=document.createElement("span");r.textContent=e.name,r.contentEditable="true",r.className="editable-name px-1 py-0.5 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",r.style.minHeight="1.5rem",r.style.display="inline-block";const s=document.createElement("button");return s.type="button",s.textContent="üóëÔ∏è",s.className="btn-danger btn-match-input",n.appendChild(r),n.appendChild(s),t.appendChild(n),{element:t,editableName:r,deleteBtn:s}}function nt({titleElement:e}){return()=>{e.style.padding="8px 12px",e.style.backgroundColor="",e.style.border="1px solid #dee2e6",setTimeout(()=>{const t=document.createRange(),n=window.getSelection();n&&(t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t))},0)}}function rt({titleElement:e,course:t,courseId:n,coursesUseCase:r,messages:s,timeouts:o}){return async()=>{if(e.dataset.saving==="true")return;e.style.transition="background-color 0.3s ease, color 0.3s ease",e.style.padding="",e.style.backgroundColor="",e.style.border="",e.style.color="";const c=e.textContent.trim();if(c&&c!==t.name)try{e.dataset.saving="true",e.contentEditable="false",await r.rename({id:n,newName:c}),t.name=c,e.style.backgroundColor="#22c55e",e.style.color="white",e.style.padding="8px 12px",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.style.padding="",e.contentEditable="true",e.dataset.saving="false"},500)}catch{e.textContent=t.name,e.style.backgroundColor="#ef4444",e.style.color="white",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.contentEditable="true",e.dataset.saving="false"},o.ERROR_FEEDBACK)}else c||(e.textContent=t.name)}}function st({titleElement:e,course:t}){return n=>{n.key==="Enter"?(n.preventDefault(),e.blur()):n.key==="Escape"&&(n.preventDefault(),e.textContent=t.name,e.blur())}}function ot({courseId:e,coursesUseCase:t,messages:n}){return async()=>{if(!window.confirm(n.CONFIRMATIONS.DELETE_COURSE))return;await t.remove({id:e})&&(location.hash="#/courses")}}function at({courseId:e,coursesUseCase:t,messages:n}){return async()=>{const r=await t.getById({id:e});if(!r||!r.students.length){alert(n.ERRORS.NO_STUDENTS_FOR_IMPRO);return}location.hash=`#/courses/${e}/impro`}}function ct({input:e,courseId:t,coursesUseCase:n,refreshStudents:r,updateGenerateImproButton:s}){return async()=>{const o=e.value.trim();o&&(await n.addStudent({courseId:t,studentName:o}),e.value="",r(),await s())}}function it({editableElement:e,student:t,courseId:n,coursesUseCase:r,timeouts:s}){return{focusHandler:()=>{e.style.padding="4px 8px",e.style.backgroundColor="",e.style.border="1px solid #dee2e6",setTimeout(()=>{const i=document.createRange(),m=window.getSelection();m&&(i.selectNodeContents(e),i.collapse(!1),m.removeAllRanges(),m.addRange(i))},0)},blurHandler:async()=>{if(e.dataset.saving==="true")return;e.style.transition="background-color 0.3s ease, color 0.3s ease",e.style.padding="",e.style.backgroundColor="",e.style.border="",e.style.color="";const i=e.textContent.trim();if(i&&i!==t.name)try{e.dataset.saving="true",e.contentEditable="false",await r.renameStudent({courseId:n,studentId:t.id,newName:i}),t.name=i,e.style.backgroundColor="#22c55e",e.style.color="white",e.style.padding="8px 12px",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.style.padding="",e.contentEditable="true",e.dataset.saving="false"},500)}catch{e.textContent=t.name,e.style.backgroundColor="#ef4444",e.style.color="white",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.contentEditable="true",e.dataset.saving="false"},s.ERROR_FEEDBACK)}else i||(e.textContent=t.name)},keydownHandler:i=>{i.key==="Enter"?(i.preventDefault(),e.blur()):i.key==="Escape"&&(i.preventDefault(),e.textContent=t.name,e.blur())}}}function lt({student:e,courseId:t,coursesUseCase:n,refreshStudents:r,updateGenerateImproButton:s,messages:o}){return async()=>{if(!window.confirm(o.CONFIRMATIONS.DELETE_STUDENT(e.name)))return;await n.removeStudent({courseId:t,studentId:e.id})&&(r(),await s())}}async function dt({root:e,params:t,deps:n}){e.innerHTML="";const r=await n.coursesUseCase.getById({id:t.id});if(!r){const g=document.createElement("div");g.className="card text-center",g.innerHTML=`<p class="text-danger">${O.ERRORS.COURSE_NOT_FOUND}</p>`,e.appendChild(g);return}const s=document.createElement("div");s.className="card",s.style.position="relative",s.style.paddingTop="3rem";const o=document.createElement("a");o.href="#/courses",o.textContent=O.LABELS.BACK_TO_COURSES,o.className="btn-secondary btn-xs",o.style.position="absolute",o.style.top="0.5rem",o.style.right="0.5rem",o.style.zIndex="10",s.appendChild(o);const{section:c,title:a,deleteBtn:i}=Qe({course:r}),m=nt({titleElement:a}),d=rt({titleElement:a,course:r,courseId:t.id,coursesUseCase:n.coursesUseCase,messages:O,timeouts:ce}),u=st({titleElement:a,course:r});if(a.addEventListener("focus",m),a.addEventListener("blur",d),a.addEventListener("keydown",u),i){const g=ot({courseId:t.id,coursesUseCase:n.coursesUseCase,messages:O});i.addEventListener("click",g)}s.appendChild(c);const{section:l,button:p}=Xe({messages:O}),N=at({courseId:t.id,coursesUseCase:n.coursesUseCase,messages:O});p.addEventListener("click",async g=>{if(p.disabled){g.preventDefault();return}await N()});async function C(){const g=await n.coursesUseCase.getById({id:t.id});!g||!g.students.length?(p.disabled=!0,p.className="btn-primary btn-lg rounded"):(p.disabled=!1,p.className="btn-primary btn-lg rounded")}await C(),s.appendChild(l);const{section:y,emptyMsg:v,list:T,form:I,input:j}=et({messages:O}),H=ct({input:j,courseId:t.id,coursesUseCase:n.coursesUseCase,refreshStudents:D,updateGenerateImproButton:C});I.addEventListener("submit",async g=>{g.preventDefault(),await H()});async function D(){const g=await n.coursesUseCase.getById({id:t.id});if(T.innerHTML="",!g||!g.students.length){v.textContent=O.LABELS.EMPTY_STUDENTS_MESSAGE;return}v.textContent="";for(const S of g.students){const{element:b,editableName:f,deleteBtn:x}=tt({student:S}),{focusHandler:A,blurHandler:L,keydownHandler:U}=it({editableElement:f,student:S,courseId:t.id,coursesUseCase:n.coursesUseCase,timeouts:ce});f.addEventListener("focus",A),f.addEventListener("blur",L),f.addEventListener("keydown",U);const R=lt({student:S,courseId:t.id,coursesUseCase:n.coursesUseCase,refreshStudents:D,updateGenerateImproButton:C,messages:O});x.addEventListener("click",R),T.appendChild(b)}}s.appendChild(y),e.appendChild(s),D()}function ut(){const e=document.createElement("button");return e.className="burger-btn",e.setAttribute("aria-label","Menu"),e.textContent="‚ò∞",e}function mt(){const e=document.createElement("nav");e.className="burger-panel",e.setAttribute("hidden","");const t=document.createElement("ul"),r=[{href:"#/courses",text:"Cours"},{href:"#/places",text:"Lieux"},{href:"#/moods",text:"√âmotions"},{href:"#/characters",text:"Personnages"}].map(s=>{const o=document.createElement("li"),c=document.createElement("a");return c.href=s.href,c.textContent=s.text,o.appendChild(c),t.appendChild(o),c});return e.appendChild(t),{panel:e,list:t,links:r}}function pt(){return document.createElement("div")}function ft({button:e,panel:t}){return()=>{t.hasAttribute("hidden")?t.removeAttribute("hidden"):t.setAttribute("hidden","")}}function gt({panel:e,links:t}){return n=>{if(n.target.tagName==="A"){if(Ct()&&!window.confirm("Vous allez perdre l'impro g√©n√©r√©e. Continuer ?")){n.preventDefault();return}e.setAttribute("hidden","")}}}function ht({container:e,button:t,panel:n}){return r=>{const s=r.target;!n.hasAttribute("hidden")&&!e.contains(s)&&s!==t&&s!==n&&n.setAttribute("hidden","")}}function Ct(){var t;const e=document.querySelector('.card[style*="display: block"]');return e&&((t=e.querySelector("h3"))==null?void 0:t.textContent)==="Impro g√©n√©r√©e"}function xt({mountOn:e}){const t=pt(),n=ut(),{panel:r,links:s}=mt(),o=ft({button:n,panel:r}),c=gt({panel:r,links:s}),a=ht({container:t,button:n,panel:r});n.addEventListener("click",o),r.addEventListener("click",c),document.addEventListener("click",a),t.appendChild(n),t.appendChild(r),e.appendChild(t)}const yt={TRANSITION_DURATION:500,ERROR_FEEDBACK_DURATION:2e3},Et={CONFIRMATIONS:{DELETE_ITEM:"Supprimer"},FEEDBACK:{SUCCESS_COLOR:"#22c55e",ERROR_COLOR:"#ef4444"}};function St({title:e,placeholder:t,emptyMessage:n,onSubmitHandler:r,createEmptyMessage:s}){const o=document.createElement("div");o.className="card";const c=document.createElement("h1");c.textContent=e,c.className="text-center mb-lg",o.appendChild(c);const a=document.createElement("form");a.className="flex gap-sm mb-lg";const i=document.createElement("input");i.type="text",i.placeholder=t,i.required=!0,i.name="itemName";const m=document.createElement("button");m.type="submit",m.textContent="+",m.className="btn-secondary btn-match-input",a.appendChild(i),a.appendChild(m),o.appendChild(a);const d=s({text:n});o.appendChild(d);const u=document.createElement("div");return u.className="flex flex-col gap-sm",o.appendChild(u),{container:o,form:a,input:i,emptyMsg:d,list:u}}function Nt({editableElement:e}){return()=>{e.style.padding="8px 12px",e.style.backgroundColor="",e.style.border="1px solid #dee2e6",setTimeout(()=>{const t=document.createRange(),n=window.getSelection();n&&(t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t))},0)}}function bt({editableElement:e,initialValue:t,itemId:n,useCase:r,onSuccess:s,timeouts:o,colors:c}){return async a=>{if(e.dataset.saving!=="true")if(e.style.transition="background-color 0.3s ease, color 0.3s ease",e.style.padding="4px 8px",e.style.backgroundColor="",e.style.border="",e.style.color="",a&&a!==t)try{e.dataset.saving="true",e.contentEditable="false",await r.rename({id:n,newName:a}),e.style.backgroundColor=c.SUCCESS_COLOR,e.style.color="white",e.style.padding="8px 12px",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.style.padding="",e.contentEditable="true",e.dataset.saving="false"},o.TRANSITION_DURATION),s()}catch{e.textContent=t,e.style.backgroundColor=c.ERROR_COLOR,e.style.color="white",setTimeout(()=>{e.style.backgroundColor="",e.style.color="",e.contentEditable="true",e.dataset.saving="false"},o.ERROR_FEEDBACK_DURATION)}else a||(e.textContent=t)}}function vt({editableElement:e,initialValue:t}){return n=>{n.key==="Enter"?(n.preventDefault(),e.blur()):n.key==="Escape"&&(n.preventDefault(),e.textContent=t,e.blur())}}function At({onClick:e}){const t=document.createElement("button");return t.type="button",t.textContent="üóëÔ∏è",t.className="btn-danger btn-match-input",t.addEventListener("click",e),t}function It({item:e,editableElement:t,deleteButton:n}){const r=document.createElement("div");r.className="card",r.style.padding="0.5rem 0.75rem",r.style.minHeight="auto";const s=document.createElement("div");return s.className="flex items-center justify-between gap-sm",s.appendChild(t),s.appendChild(n),r.appendChild(s),r}function Tt({text:e,className:t="text-center text-muted mb-md"}){const n=document.createElement("p");return n.className=t,n.textContent=e,n}function ee({root:e,config:t}){e.innerHTML="";let n=[];function r({item:d}){let u=d.name;const l=document.createElement("span");l.textContent=u,l.contentEditable="true",l.className="editable-name px-1 py-0.5 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",l.style.minHeight="1.5rem",l.style.display="inline-block";const p=At({onClick:async()=>{if(!window.confirm(`Supprimer ${t.entityName} "${d.name}" ?`))return;await t.useCase.remove({id:d.id})&&s()}}),N=Nt({editableElement:l}),C=bt({editableElement:l,initialValue:u,itemId:d.id,useCase:t.useCase,onSuccess:s,timeouts:yt,colors:Et.FEEDBACK}),y=vt({editableElement:l,initialValue:u});return l.addEventListener("focus",N),l.addEventListener("blur",()=>C(l.textContent.trim())),l.addEventListener("keydown",y),It({item:d,editableElement:l,deleteButton:p})}async function s(){if(n=await t.useCase.list(),m.innerHTML="",!n.length)i.textContent=t.emptyMessage;else{i.textContent="";for(const d of n){const u=r({item:d});m.appendChild(u)}}}const{container:o,form:c,input:a,emptyMsg:i,list:m}=St({title:t.title,placeholder:t.placeholder,emptyMessage:t.emptyMessage,onSubmitHandler:async()=>{const d=a.value.trim();d&&(await t.useCase.create({name:d}),a.value="",s())},createEmptyMessage:Tt});c.addEventListener("submit",async d=>{d.preventDefault();const u=a.value.trim();u&&(await t.useCase.create({name:u}),a.value="",s())}),e.appendChild(o),s()}function Lt({root:e,deps:t}){ee({root:e,config:{title:"Lieux",placeholder:"Nom du lieu",emptyMessage:"Ajoutez votre premier lieu",entityName:"le lieu",useCase:t.placesUseCase}})}function Rt({root:e,deps:t}){ee({root:e,config:{title:"√âmotions",placeholder:"Nom de l'√©motion",emptyMessage:"Ajoutez votre premi√®re √©motion",entityName:"l'√©motion",useCase:t.moodsUseCase}})}function wt({root:e,deps:t}){ee({root:e,config:{title:"Personnages",placeholder:"Nom du personnage",emptyMessage:"Ajoutez votre premier personnage",entityName:"le personnage",useCase:t.charactersUseCase}})}function ie({course:e,selectedStudents:t,onToggle:n,onSelectAll:r,createStudentCard:s}){const o=document.createElement("div");o.className="mb-md";const c=document.createElement("h3");c.textContent="S√©lectionner les √©l√®ves",c.className="mb-sm text-base",o.appendChild(c);const a=document.createElement("button");a.type="button",a.textContent=t.size===e.students.length&&e.students.length>0?"Tout d√©-s√©lectionner":"Tout s√©lectionner",a.className="btn-secondary btn-sm mb-sm",o.appendChild(a);const i=document.createElement("div");return i.className="flex flex-col gap-xs max-h-48 overflow-y-auto",e.students.forEach(m=>{const d=s(m,t.has(m.id),n);i.appendChild(d)}),o.appendChild(i),{section:o,selectAllBtn:a}}function le({placesCount:e,onPlacesCountChange:t,maxPlaces:n}){const r=document.createElement("div");r.className="mb-md";const s=document.createElement("label");s.textContent="Nombre de lieux: ",s.className="font-medium mb-xs block text-sm";const o=document.createElement("div");o.className="flex items-center gap-sm";const c=document.createElement("button");c.type="button",c.textContent="-",c.className="btn-secondary btn-match-input",c.disabled=e<=1;const a=document.createElement("input");a.type="number",a.min="1",a.max=n.toString(),a.value=e.toString(),a.className="w-auto text-center",a.style.width="80px";const i=document.createElement("button");return i.type="button",i.textContent="+",i.className="btn-secondary btn-match-input",i.disabled=e>=n,o.appendChild(c),o.appendChild(a),o.appendChild(i),s.appendChild(o),r.appendChild(s),{section:r,decrementBtn:c,placesInput:a,incrementBtn:i}}function Ot({places:e,onRegenerate:t,onDelete:n}){const r=document.createElement("div");r.className="flex flex-col gap-xs mb-md";const s=[],o=[];return e.forEach((c,a)=>{const i=document.createElement("div");i.className="card p-sm";const m=document.createElement("div");m.className="inline-edit-container";const d=document.createElement("span");d.textContent=c.name,d.className="font-medium text-sm";const u=document.createElement("div");u.className="btn-group";const l=document.createElement("button");l.type="button",l.textContent="üîÑ",l.className="btn-secondary btn-compact";const p=document.createElement("button");p.type="button",p.textContent="üóëÔ∏è",p.className="btn-danger btn-compact",p.disabled=e.length<=1,u.appendChild(l),u.appendChild(p),m.appendChild(d),m.appendChild(u),i.appendChild(m),r.appendChild(i),s.push(l),o.push(p)}),{list:r,regenerateButtons:s,deleteButtons:o}}function Ut({assignments:e,onRegenerateCharacter:t,onRegenerateMood:n,onDeleteStudent:r}){const s=document.createElement("div");s.className="flex flex-col gap-xs";const o=[],c=[],a=[];return e.forEach((i,m)=>{const d=document.createElement("div");d.className="card p-sm";const u=document.createElement("div");u.className="text-base font-semibold mb-xs",u.textContent=i.student.name,d.appendChild(u);const l=document.createElement("div");l.className="flex justify-between items-center mb-xs";const p=document.createElement("span");p.textContent=i.character.name,p.className="font-medium text-sm";const N=document.createElement("button");N.type="button",N.textContent="üîÑ",N.className="btn-secondary btn-match-input",l.appendChild(p),l.appendChild(N),d.appendChild(l);const C=document.createElement("div");C.className="flex justify-between items-center mb-xs";const y=document.createElement("span");y.textContent=i.mood.name,y.className="text-secondary text-sm";const v=document.createElement("button");v.type="button",v.textContent="üîÑ",v.className="btn-secondary btn-match-input",C.appendChild(y),C.appendChild(v),d.appendChild(C);const T=document.createElement("div");T.className="flex justify-end mt-xs";const I=document.createElement("button");I.type="button",I.textContent="üóëÔ∏è Supprimer l'√©l√®ve de l'impro",I.className="btn-danger btn-sm",I.disabled=e.length<=1,T.appendChild(I),d.appendChild(T),s.appendChild(d),o.push(N),c.push(v),a.push(I)}),{list:s,regenerateCharacterButtons:o,regenerateMoodButtons:c,deleteStudentButtons:a}}function de({studentId:e,selectedStudents:t,onUpdate:n}){return()=>{t.has(e)?t.delete(e):t.add(e),n()}}function z({course:e,selectedStudents:t,onUpdate:n}){return()=>{t.size===e.students.length?t.clear():(t.clear(),e.students.forEach(r=>t.add(r.id))),n()}}function Pt({selectedStudents:e,placesCount:t,course:n,deps:r,onImproGenerated:s,messages:o}){return async()=>{const c=r.validationUseCase.validateStudentSelection({selectedStudents:e,course:n});if(c){alert(c);return}const a=await r.placesUseCase.list(),i=r.validationUseCase.validatePlacesCount({placesCount:t,availablePlaces:a.length});if(i){alert(i);return}try{const m=n.students.filter(u=>e.has(u.id)),d=await r.improGenerationUseCase.generate({students:m,placesCount:t});s(d)}catch(m){alert(`${o.ERRORS.GENERATION_FAILED}: ${m.message}`)}}}function ue({places:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{try{const o=await n.regenerationUseCase.regeneratePlace({currentPlaces:e,placeIndex:t});e[t]=o,r()}catch(o){alert(`${s.ERRORS.REGENERATION_FAILED}: ${o.message}`)}}}function me({places:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{const o=e[t].name;await n.deletionUseCase.confirmDeletion({confirmationMessage:s.CONFIRMATIONS.DELETE_PLACE(o)})&&(e.splice(t,1),r())}}function pe({assignments:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{try{const o=await n.regenerationUseCase.regenerateCharacter({currentAssignments:e,assignmentIndex:t});e[t].character=o,r()}catch(o){alert(`${s.ERRORS.REGENERATION_FAILED}: ${o.message}`)}}}function fe({assignments:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{try{const o=await n.regenerationUseCase.regenerateMood({currentAssignments:e,assignmentIndex:t});e[t].mood=o,r()}catch(o){alert(`${s.ERRORS.REGENERATION_FAILED}: ${o.message}`)}}}function ge({assignments:e,index:t,deps:n,onUpdate:r,messages:s}){return async()=>{const o=e[t].student.name;await n.deletionUseCase.confirmDeletion({confirmationMessage:s.CONFIRMATIONS.DELETE_STUDENT(o)})&&(e.splice(t,1),r())}}const _t={DEFAULT_PLACES_COUNT:1},E={ERRORS:{NO_STUDENTS_SELECTED:"S√©lectionnez au moins un √©l√®ve",TOO_MANY_STUDENTS:"Trop d'√©l√®ves s√©lectionn√©s",INVALID_PLACES_COUNT:"Nombre de lieux invalide",NO_PLACES_AVAILABLE:"Aucun lieu disponible",NO_CHARACTERS_AVAILABLE:"Aucun personnage disponible",NO_MOODS_AVAILABLE:"Aucune √©motion disponible",NOT_ENOUGH_CHARACTERS:"Pas assez de personnages pour tous les √©l√®ves",NOT_ENOUGH_PLACES:"Pas assez de lieux disponibles",GENERATION_FAILED:"Erreur lors de la g√©n√©ration de l'impro",REGENERATION_FAILED:"Erreur lors de la r√©g√©n√©ration",DELETION_FAILED:"Erreur lors de la suppression"},CONFIRMATIONS:{DELETE_PLACE:e=>`Supprimer le lieu "${e}" de l'impro ?`,DELETE_STUDENT:e=>`Supprimer l'√©l√®ve "${e}" de l'impro ?`,NAVIGATE_AWAY:"Vous allez perdre l'impro g√©n√©r√©e. Continuer ?"},SUCCESS:{IMPRO_GENERATED:"Impro g√©n√©r√©e avec succ√®s",ELEMENT_REGENERATED:"√âl√©ment r√©g√©n√©r√© avec succ√®s",ELEMENT_DELETED:"√âl√©ment supprim√© avec succ√®s"},LABELS:{STUDENT_SELECTION:"S√©lectionner les √©l√®ves",PLACES_COUNT:"Nombre de lieux: ",GENERATE_IMPRO:"üé≠ G√©n√©rer une impro",SELECT_ALL:"Tout s√©lectionner",DESELECT_ALL:"Tout d√©-s√©lectionner",PLACES_TITLE:"Lieux:",ASSIGNMENTS_TITLE:"Attributions:",IMPRO_GENERATED_TITLE:"Impro g√©n√©r√©e"}};function he({student:e,isSelected:t,onToggle:n}){const r=document.createElement("div");r.className="card p-sm";const s=document.createElement("label");s.className="flex items-center gap-xs cursor-pointer w-full";const o=document.createElement("input");return o.type="checkbox",o.value=e.id,o.checked=t,o.addEventListener("change",()=>{n(e.id)}),s.appendChild(o),s.appendChild(document.createTextNode(e.name)),r.appendChild(s),r}async function Mt({root:e,params:t,deps:n}){e.innerHTML="";const r=await n.coursesUseCase.getById({id:t.courseId});if(!r){const f=document.createElement("div");f.className="card text-center",f.innerHTML='<p class="text-danger">Cours introuvable</p>',e.appendChild(f);return}let s=new Set,o=_t.DEFAULT_PLACES_COUNT,c=!1,a=null,i=1;i=(await n.placesUseCase.list()).length;const d=r,u=document.createElement("div");u.className="card",u.style.position="relative",u.style.paddingTop="3rem";const l=document.createElement("a");l.href=`#/courses/${t.courseId}`,l.textContent="‚Üê Retour au cours",l.className="btn-secondary btn-xs",l.style.position="absolute",l.style.top="0.5rem",l.style.right="0.5rem",l.style.zIndex="10",l.addEventListener("click",f=>{c&&(window.confirm(E.CONFIRMATIONS.NAVIGATE_AWAY)||f.preventDefault())}),u.appendChild(l);const p=document.createElement("div");p.className="flex justify-center items-center mb-md";const N=document.createElement("h1");N.textContent=`Impro : ${d.name}`,N.className="mb-0 text-lg",p.appendChild(N),u.appendChild(p);function C(){const f=u.querySelector(".student-selection-section");f&&f.remove();const{section:x,selectAllBtn:A}=ie({course:d,selectedStudents:s,onToggle:L=>de({studentId:L,selectedStudents:s,onUpdate:C})(),onSelectAll:z({course:d,selectedStudents:s,onUpdate:C}),createStudentCard:(L,U,R)=>he({student:L,isSelected:U,onToggle:R})});x.className+=" student-selection-section",A.addEventListener("click",z({course:d,selectedStudents:s,onUpdate:C})),u.insertBefore(x,u.querySelector(".places-section")),g.disabled=s.size===0}function y(f){o=f;const x=u.querySelector(".places-section");x&&x.remove();const{section:A,decrementBtn:L,placesInput:U,incrementBtn:R}=le({placesCount:o,onPlacesCountChange:y,maxPlaces:i});A.className+=" places-section",L.addEventListener("click",()=>{o>1&&y(o-1)}),U.addEventListener("input",()=>{const K=parseInt(U.value)||1,q=Math.max(1,Math.min(i,K));y(q)}),R.addEventListener("click",()=>{o<i&&y(o+1)}),u.insertBefore(A,g)}const{section:v,selectAllBtn:T}=ie({course:d,selectedStudents:s,onToggle:f=>de({studentId:f,selectedStudents:s,onUpdate:C})(),onSelectAll:z({course:d,selectedStudents:s,onUpdate:C}),createStudentCard:(f,x,A)=>he({student:f,isSelected:x,onToggle:A})});v.className+=" student-selection-section",T.addEventListener("click",z({course:d,selectedStudents:s,onUpdate:C})),u.appendChild(v);const{section:I,decrementBtn:j,placesInput:H,incrementBtn:D}=le({placesCount:o,onPlacesCountChange:y,maxPlaces:i});I.className+=" places-section",j.addEventListener("click",()=>{o>1&&y(o-1)}),H.addEventListener("input",()=>{const f=parseInt(H.value)||1,x=Math.max(1,Math.min(i,f));y(x)}),D.addEventListener("click",()=>{o<i&&y(o+1)}),u.appendChild(I);const g=document.createElement("button");g.textContent=E.LABELS.GENERATE_IMPRO,g.className="btn-primary btn-lg mb-md",g.disabled=!0,g.addEventListener("click",async()=>{await Pt({selectedStudents:s,placesCount:o,course:d,deps:n,onImproGenerated:A=>{a=A,c=!0,b()},messages:E})()}),u.appendChild(g);const S=document.createElement("div");S.className="card",S.style.display="none",u.appendChild(S),e.appendChild(u);function b(){if(!a)return;S.style.display="block",S.innerHTML="";const f=document.createElement("h3");f.textContent=E.LABELS.IMPRO_GENERATED_TITLE,f.className="text-center mb-md text-lg",S.appendChild(f);const x=document.createElement("h4");x.textContent=E.LABELS.PLACES_TITLE,x.className="mb-sm text-base",S.appendChild(x);const{list:A,regenerateButtons:L,deleteButtons:U}=Ot({places:a.places,onRegenerate:h=>ue({places:a.places,index:h,deps:n,onUpdate:b,messages:E})(),onDelete:h=>me({places:a.places,index:h,deps:n,onUpdate:b,messages:E})()});L.forEach((h,w)=>{h.addEventListener("click",()=>ue({places:a.places,index:w,deps:n,onUpdate:b,messages:E})())}),U.forEach((h,w)=>{h.addEventListener("click",()=>me({places:a.places,index:w,deps:n,onUpdate:b,messages:E})())}),S.appendChild(A);const R=document.createElement("h4");R.textContent=E.LABELS.ASSIGNMENTS_TITLE,R.className="mb-sm text-base",S.appendChild(R);const{list:K,regenerateCharacterButtons:q,regenerateMoodButtons:Ne,deleteStudentButtons:be}=Ut({assignments:a.assignments,onRegenerateCharacter:h=>pe({assignments:a.assignments,index:h,deps:n,onUpdate:b,messages:E})(),onRegenerateMood:h=>fe({assignments:a.assignments,index:h,deps:n,onUpdate:b,messages:E})(),onDeleteStudent:h=>ge({assignments:a.assignments,index:h,deps:n,onUpdate:b,messages:E})()});q.forEach((h,w)=>{h.addEventListener("click",()=>pe({assignments:a.assignments,index:w,deps:n,onUpdate:b,messages:E})())}),Ne.forEach((h,w)=>{h.addEventListener("click",()=>fe({assignments:a.assignments,index:w,deps:n,onUpdate:b,messages:E})())}),be.forEach((h,w)=>{h.addEventListener("click",()=>ge({assignments:a.assignments,index:w,deps:n,onUpdate:b,messages:E})())}),S.appendChild(K)}}try{const e=Ie();e.success&&e.migratedKeys.length>0&&console.log(`‚úÖ Migration r√©ussie: ${e.totalItems} √©l√©ments migr√©s`)}catch(e){console.error("‚ùå Erreur lors de la migration des donn√©es:",e)}"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{const e=await navigator.serviceWorker.ready;console.log("Service worker ready:",e.scope)}catch{console.log("Service worker not ready yet")}});const _=document.getElementById("app");if(_){const e=ze(),t=document.getElementById("menu");t&&xt({mountOn:t}),new Ke([{path:"/courses",handler:()=>Ze({root:_,deps:e})},{path:"/courses/:id",handler:r=>dt({root:_,params:r,deps:e})},{path:"/courses/:courseId/impro",handler:r=>Mt({root:_,params:r,deps:e})},{path:"/places",handler:()=>Lt({root:_,deps:e})},{path:"/moods",handler:()=>Rt({root:_,deps:e})},{path:"/characters",handler:()=>wt({root:_,deps:e})}]).start()}
